CREATE TABLE bonus (user_id BIGINT UNIQUE, bonus FLOAT(18, 2) DEFAULT 50 NOT NULL, PRIMARY KEY(user_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE category (id BIGINT AUTO_INCREMENT, name VARCHAR(64) NOT NULL UNIQUE, description VARCHAR(128), slug VARCHAR(255), UNIQUE INDEX category_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE city (id BIGINT AUTO_INCREMENT, name VARCHAR(64) NOT NULL UNIQUE, country_id BIGINT NOT NULL, slug VARCHAR(255), UNIQUE INDEX city_sluggable_idx (slug), INDEX country_id_idx (country_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE comment (id BIGINT AUTO_INCREMENT, project_id BIGINT NOT NULL, user_id BIGINT NOT NULL, cost FLOAT(7, 2), currency_id BIGINT NOT NULL, cost_type VARCHAR(255) DEFAULT 'цена за проект', term BIGINT UNSIGNED, term_options VARCHAR(255) DEFAULT 'День' NOT NULL, is_security_deal TINYINT(1) DEFAULT '0' NOT NULL, is_active TINYINT(1) DEFAULT '1' NOT NULL, is_candidate TINYINT(1) DEFAULT '0' NOT NULL, is_performer TINYINT(1) DEFAULT '0' NOT NULL, comment TEXT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX project_id_idx (project_id), INDEX user_id_idx (user_id), INDEX currency_id_idx (currency_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE country (id BIGINT AUTO_INCREMENT, name VARCHAR(64) NOT NULL UNIQUE, slug VARCHAR(255), UNIQUE INDEX country_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE currency (id BIGINT AUTO_INCREMENT, name VARCHAR(16) NOT NULL UNIQUE, coef FLOAT(8, 2) DEFAULT 1 NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE project (id BIGINT AUTO_INCREMENT, name VARCHAR(80) NOT NULL, small_description VARCHAR(100) NOT NULL, description TEXT NOT NULL, file_src VARCHAR(255), category_id BIGINT NOT NULL, work_type VARCHAR(255) DEFAULT 'Проекты', office_country_id BIGINT, office_city_id BIGINT, is_budget_by_agreement TINYINT(1) DEFAULT '0' NOT NULL, budget FLOAT(8, 2) DEFAULT 0 NOT NULL, budget_currency_id BIGINT, budget_type VARCHAR(255) DEFAULT 'цена за проект', is_security_deal TINYINT(1) DEFAULT '0' NOT NULL, expires_at DATETIME NOT NULL, term BIGINT, term_options VARCHAR(255) DEFAULT 'День' NOT NULL, owner_id BIGINT NOT NULL, is_active TINYINT(1) DEFAULT '1' NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, slug VARCHAR(255), UNIQUE INDEX project_sluggable_idx (slug), INDEX category_id_idx (category_id), INDEX office_country_id_idx (office_country_id), INDEX office_city_id_idx (office_city_id), INDEX budget_currency_id_idx (budget_currency_id), INDEX owner_id_idx (owner_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_forgot_password (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, unique_key VARCHAR(255), expires_at DATETIME NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id BIGINT AUTO_INCREMENT, user_id BIGINT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user (id BIGINT AUTO_INCREMENT, first_name VARCHAR(255), last_name VARCHAR(255), email_address VARCHAR(255) NOT NULL UNIQUE, username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '0', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id BIGINT, group_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
ALTER TABLE city ADD CONSTRAINT city_country_id_country_id FOREIGN KEY (country_id) REFERENCES country(id);
ALTER TABLE comment ADD CONSTRAINT comment_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id);
ALTER TABLE comment ADD CONSTRAINT comment_project_id_project_id FOREIGN KEY (project_id) REFERENCES project(id);
ALTER TABLE comment ADD CONSTRAINT comment_currency_id_currency_id FOREIGN KEY (currency_id) REFERENCES currency(id);
ALTER TABLE project ADD CONSTRAINT project_owner_id_sf_guard_user_id FOREIGN KEY (owner_id) REFERENCES sf_guard_user(id);
ALTER TABLE project ADD CONSTRAINT project_office_country_id_country_id FOREIGN KEY (office_country_id) REFERENCES country(id);
ALTER TABLE project ADD CONSTRAINT project_office_city_id_city_id FOREIGN KEY (office_city_id) REFERENCES city(id);
ALTER TABLE project ADD CONSTRAINT project_category_id_category_id FOREIGN KEY (category_id) REFERENCES category(id);
ALTER TABLE project ADD CONSTRAINT project_budget_currency_id_currency_id FOREIGN KEY (budget_currency_id) REFERENCES currency(id);
ALTER TABLE sf_guard_forgot_password ADD CONSTRAINT sf_guard_forgot_password_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
